This would be part of the 'small programs' repository, but 850 lines (and counting) in the main file isn't exactly small.
